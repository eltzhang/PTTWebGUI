var fgNet=new Object();fgNet.READY_STATE_UNINITIALIZED=0;fgNet.READY_STATE_LOADING=1;fgNet.READY_STATE_LOADED=2;fgNet.READY_STATE_INTERACTIVE=3;fgNet.READY_STATE_COMPLETE=4;fgNet.GET_REQUEST="GET";fgNet.POST_REQUEST="POST";fgNet.executeRequest=function(c,e,d,b,a){if(trim(e.toUpperCase())!=fgNet.POST_REQUEST){this.method=fgNet.GET_REQUEST}else{this.method=e.toUpperCase()}this.url=c+"&inSitetime="+new Date().getTime();this.url=addCSRFTokenToURL(this.url);this.xmlRequest=null;this.stateListener=b;this.errorListner=(a)?a:this.defaultErrorListener;document.cookie="lastAccessTime="+new Date().getTime();this.sendRequest(d)};fgNet.executeRequest.prototype={sendRequest:function(b){this.xmlRequest=fgNet.xmlHttpRequest();if(this.xmlRequest){try{var a=this;this.xmlRequest.open(this.method,this.url,true);this.xmlRequest.onreadystatechange=function(){a.stateListenerCaller(a)};if(this.method==fgNet.GET_REQUEST){this.xmlRequest.send(null)}else{this.xmlRequest.setRequestHeader("Content-type","application/x-www-form-urlencoded");this.xmlRequest.send(b)}}catch(c){this.errorListner.call(this,c)}}},stateListenerCaller:function(){var a=this.xmlRequest;if(a.readyState==fgNet.READY_STATE_COMPLETE){if(a.status==200||a.status==0){this.stateListener.call(this,a.responseText)}else{this.errorListner.call(this,a.responseText)}}},defaultErrorListener:function(){alert("error! we are not able to complete your request at the movement. Check if you are connected to Internet and you are actively logged in\n\nreadyState:"+this.xmlRequest.readyState+"\nstatus: "+this.xmlRequest.status+"\nheaders: "+this.xmlRequest.getAllResponseHeaders())}};fgNet.xmlHttpRequest=function(){if(!window.XMLHttpRequest){var a;var d=false;var e=new Array("Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP");for(var b=0;b<e.length&&!d;b++){try{a=new ActiveXObject(e[b]);d=true}catch(c){}}if(!d){alert("Could not retreive a valid XMLHttp")}return a}else{return new XMLHttpRequest()}};